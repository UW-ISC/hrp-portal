"use strict";(self.webpackChunkgravityforms=self.webpackChunkgravityforms||[]).push([[514],{1589:function(e,t,i){i.r(t),i.d(t,{default:function(){return Y}});var n,a,r,o,l,s,d,c,p,u,g,f,m,v,b=i(1236),h=i(2340),y=i.n(h),_=i(7329),w=i.n(_),O=i(5311),T=i(191),j=i.n(T),x=i(5518),E=i(107),L=i(7536),A=i.n(L),C=(null===(n=window)||void 0===n?void 0:n.form)||{},P=(null===(a=window)||void 0===a?void 0:a.GetInputType)||null,I=(null===(r=window)||void 0===r?void 0:r.GetLabel)||null,k=(null===(o=window)||void 0===o?void 0:o.GetInput)||null,F=(null===(l=window)||void 0===l?void 0:l.Copy)||null,q=(null===(s=window)||void 0===s?void 0:s.IsPricingField)||null,S=(null===(d=window)||void 0===d?void 0:d.HasPostField)||null,D=function(e,t){var i=e.classList.value;if(!i)return"";var n=i.split(" ");for(var a in n)if(Object.prototype.hasOwnProperty.call(n,a)){var r=n[a].split("-");if("mt"==r[0]&&r[1]==t)return r.length>3?(delete r[0],delete r[1],r):2===r.length||r[2]}return""},z=function(e){for(var t in A().mergeTags)if(Object.prototype.hasOwnProperty.call(A().mergeTags,t)){var i=A().mergeTags[t].tags;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)&&i[n].tag==e)return i[n].label}return""},B=function(e){return A().mergeTags[e].label},G=function(e,t){void 0===t&&(t="");var i=[],n=P(e),a="list"===n?":"+t:"",r="",o="",l="";if(O.inArray(n,["date","email","time","password"])>-1&&(l=e.inputs,e.inputs=null),void 0!==e.inputs&&O.isArray(e.inputs)){for(var s in"checkbox"===n&&(r="{"+(o=I(e,e.id).replace("'","\\'"))+":"+e.id+a+"}",i.push({tag:r,label:o})),e.inputs)if(Object.prototype.hasOwnProperty.call(e.inputs,s)){var d=e.inputs[s];"creditcard"===n&&O.inArray(parseFloat(d.id),[parseFloat(e.id+".2"),parseFloat(e.id+".3"),parseFloat(e.id+".5")])>-1||(r="{"+(o=I(e,d.id).replace("'","\\'"))+":"+d.id+a+"}",i.push({tag:r,label:o}))}}else r="{"+(o=I(e).replace("'","\\'"))+":"+e.id+a+"}",i.push({tag:r,label:o});return O.inArray(n,["date","email","time","password"])>-1&&(e.inputs=l),i},H=function(e){var t="number"===e.type&&e.enableCalculation,i="product"===e.type&&"calculation"===e.inputType&&e.enableCalculation,n="post_custom_field"===e.type&&"number"===e.inputType;return t||i||n},V=function(e){var t=C.fields,i=e.getAttribute("id"),n=e.classList.contains("merge-tag-calculation"),a=["text","select","number","checkbox","radio","hidden","singleproduct","price","hiddenproduct","calculation","singleshipping"],r=!1;if(n){t.forEach((function(e){H(e)&&(r=!0)}));var o=[];if(r)return t.forEach((function(e){if(e.inputType||(e.inputType=e.type),a.includes(e.inputType))if("checkbox"===e.inputType&&e.choices){var t=1;e.choices.forEach((function(i){o.push({value:"{".concat(i.text,":").concat(e.id,".").concat(t,"}"),label:i.text}),t++}))}else"product"===e.type&&e.inputs?e.inputs.forEach((function(t){o.push({value:"{".concat(e.label," (").concat(t.label,"):").concat(t.id,"}"),label:"".concat(e.label," (").concat(t.label,")")})})):o.push({value:"{".concat(e.label,":").concat(e.id,"}"),label:e.label})})),o;c=new Event("gform/layout_editor/merge_tags_first_load"),document.dispatchEvent(c)}var l=!0===D(e,"hide_all_fields"),s=D(e,"exclude"),d=D(e,"prepopulate");d&&(l=!0);var p=function(e,t,i,n,a,r){void 0===e&&(e=[]),void 0===n&&(n=[]);var o=[],l=[],s=[],d=[],c=[],p=[],u=[],g=[],f=[];if(i||s.push({tag:"{all_fields}",label:z("{all_fields}")}),!a){for(var m in e)if(Object.prototype.hasOwnProperty.call(e,m)){var v=e[m];if(!v.displayOnly){var b=P(v);if(-1===O.inArray(b,n)){if(v.isRequired)if("name"===b){var h=F(v),_=void 0,w=void 0,T=void 0,j=void 0;"extended"===v.nameFormat?(_=k(v,v.id+".2"),T=k(v,v.id+".8"),(j=F(v)).inputs=[_,T],l.push(j),delete h.inputs[0],delete h.inputs[3]):"advanced"===v.nameFormat&&(_=k(v,v.id+".2"),w=k(v,v.id+".4"),T=k(v,v.id+".8"),(j=F(v)).inputs=[_,w,T],l.push(j),delete h.inputs[0],delete h.inputs[2],delete h.inputs[4]),o.push(h)}else o.push(v);else l.push(v);q(v.type)&&u.push(v)}}}if(o.length>0)for(var x in o)Object.prototype.hasOwnProperty.call(o,x)&&(g=g.concat(G(o[x],r)));if(l.length>0)for(var E in l)Object.prototype.hasOwnProperty.call(l,E)&&"submit"!==l[E].type&&(f=f.concat(G(l[E],r)));if(u.length>0)for(var L in i||d.push({tag:"{pricing_fields}",label:z("{pricing_fields}")}),u)Object.prototype.hasOwnProperty.call(u,L)&&d.concat(G(u[L],r))}var C=["ip","date_mdy","date_dmy","embed_post:ID","embed_post:post_title","embed_url","entry_id","entry_url","form_id","form_title","user_agent","referer","post_id","post_edit_url","user:display_name","user:user_email","user:user_login"];for(var I in a&&(C.splice(C.indexOf("entry_id"),1),C.splice(C.indexOf("entry_url"),1),C.splice(C.indexOf("form_id"),1),C.splice(C.indexOf("form_title"),1)),S()&&!a||(C.splice(C.indexOf("post_id"),1),C.splice(C.indexOf("post_edit_url"),1)),C)-1===O.inArray(C[I],n)&&c.push({tag:"{"+C[I]+"}",label:z("{"+C[I]+"}")});var D=function(){for(var e in A().mergeTags)if(Object.prototype.hasOwnProperty.call(A().mergeTags,e)&&"custom"===e)return A().mergeTags[e];return[]}();if(D.tags.length>0)for(var H in D.tags)if(Object.prototype.hasOwnProperty.call(D.tags,H)){var V=D.tags[H];p.push({tag:V.tag,label:V.label})}var M={ungrouped:{label:B("ungrouped"),tags:s},required:{label:B("required"),tags:g},optional:{label:B("optional"),tags:f},pricing:{label:B("pricing"),tags:d},other:{label:B("other"),tags:c},custom:{label:B("custom"),tags:p}};return y().applyFilters("gform_merge_tags",M,t,i,n,a,r,void 0)}(t,i,l,s,d,D(e,"option")),u=function(e){var t=0;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&e[i].tags.length>0&&t++;return t>1}(p),g=[];for(var f in p)if(Object.prototype.hasOwnProperty.call(p,f)){var m=p[f].label,v=p[f].tags,b=m&&u;if(!(v.length<=0)){var h=v.map((function(e){return{value:e.tag,label:y().tools.stripSlashes(e.label)}}));b?g.push({label:m,listData:h}):g.push.apply(g,(0,E.Z)(h))}}return g},M=(null===w()||void 0===w()||null===(p=w().components)||void 0===p?void 0:p.merge_tags)||{},N=(null===(u=window)||void 0===u?void 0:u.InsertVariable)||null,Z=(null===(g=window)||void 0===g?void 0:g.InsertEditorVariable)||null,R=(null===(f=window)||void 0===f?void 0:f.form)||{},J=function(e){this.isEditor?Z(this.elem.getAttribute("id"),e):N(this.elem.getAttribute("id"),null,e),O(this.elem).trigger("input").trigger("propertychange")},K=function(){if(y().simplebar.initializeInstances(),function(e){var t=document.querySelector('[data-js="'.concat(e,'"]')),i=(0,x.getClosest)(t,".panel-block-tabs__body");if(i){var n=250-i.offsetHeight,a=window.getComputedStyle(i).getPropertyValue("padding-bottom");n<10||(i.setAttribute("data-js-initial-padding",a),i.style.paddingBottom="".concat(n,"px"))}}(this.selector),(0,x.browsers)().firefox){var e=document.querySelector('[data-js="'.concat(this.selector,'"]'));e.querySelector(".gform-dropdown__container").removeAttribute("style"),x.simpleBar.reInitChildren(e)}},Q=function(){var e,t,i;e=this.selector,t=document.querySelector('[data-js="'.concat(e,'"]')),(i=(0,x.getClosest)(t,".panel-block-tabs__body"))&&i.hasAttribute("data-js-initial-padding")&&(i.style.paddingBottom=i.getAttribute("data-js-initial-padding"),i.removeAttribute("data-js-initial-padding"))},U=function(){(0,x.getNodes)(".merge-tag-support:not(.mt-initialized)",!0,document,!0).forEach((function(e){(function(e,t){var i=V(e),n=D(e,"manual_position"),a=n?function(e){var t=(0,x.getClosest)(e,".wp-editor-wrap").querySelector(".wp-media-buttons");return(0,x.getChildren)(t).slice(-1).pop()}(e):e,r=function(e,t){var i=D(e,"manual_position"),n=document.createElement("span");return n.classList.add("all-merge-tags"),n.classList.add("gform-merge-tags-dropdown-wrapper"),n.classList.add(e.tagName.toLowerCase()),i?n.classList.add("left"):n.classList.add("right"),n.setAttribute("mt-dropdown-".concat(t),!0),n.innerHTML='<span data-js="gform-dropdown-mt-wrapper-'.concat(t,'"></span>'),n}(e,t);(0,x.insertAfter)(r,a),y().instances.mergeTags.push(new(j())({container:"mt-dropdown-".concat(t),selector:"gform-dropdown-mt-".concat(t),renderTarget:'[data-js="gform-dropdown-mt-wrapper-'.concat(t,'"]'),swapLabel:!1,listData:i,render:!0,triggerPlaceholder:(0,x.saferHtml)(m||(m=(0,b.Z)(['<i class="gform-icon gform-icon--merge-tag gform-button__icon"></i>']))),triggerTitle:M.i18n.insert_merge_tags,wrapperClasses:"gform-dropdown gform-dropdown--merge-tags",triggerId:"mt-dropdown--trigger-".concat(t),triggerAriaId:"mt-dropdown--trigger-label-".concat(t),triggerClasses:"ui-state-disabled",onItemSelect:J.bind({isEditor:n,idx:t,elem:e}),searchPlaceholder:M.i18n.search_merge_tags,onOpen:K.bind({selector:"gform-dropdown-mt-".concat(t)}),onClose:Q.bind({selector:"gform-dropdown-mt-".concat(t)}),dropdownListAttributes:'data-js="gform-simplebar"',hasSearch:!a.classList.contains("merge-tag-calculation")}))})(e,(0,x.uniqueId)()),function(e){var t=(0,x.getClosest)(e,".field_setting"),i=(0,x.getClosest)(e,".gform-settings-field");t?t.classList.add("field_setting--with-merge-tag"):i&&i.classList.add("gform-settings-field--with-merge-tag")}(e),e.classList.add("mt-initialized")}))},W=function(){var e=R.fields,t=["text","select","number","checkbox","radio","hidden","singleproduct","price","hiddenproduct","calculation","singleshipping"],i=!1,n=[];if(e.forEach((function(e){if(e.inputType||(e.inputType=e.type),H(e)&&(i=!0),t.includes(e.inputType))if("checkbox"===e.inputType&&e.choices){var a=1;e.choices.forEach((function(t){n.push({value:"{".concat(t.text,":").concat(e.id,".").concat(a,"}"),label:t.text}),a++}))}else"product"===e.type&&e.inputs?e.inputs.forEach((function(t){n.push({value:"{".concat(e.label," (").concat(t.label,"):").concat(t.id,"}"),label:"".concat(e.label," (").concat(t.label,")")})})):n.push({value:"{".concat(e.label,":").concat(e.id,"}"),label:e.label})})),i){var a=X();a.options.listData=n,a.renderListData()}v=new Event("gform/layout_editor/merge_tags_update"),document.dispatchEvent(v)},X=function(){var e=document.getElementById("calculation_options");if(!e)return null;for(var t=0;t<y().instances.mergeTags.length;t++){var i=y().instances.mergeTags[t],n=i.elements.container;if(e.contains(n))return i}return null},Y=function(){y().instances=(null===y()||void 0===y()?void 0:y().instances)||{},y().instances.mergeTags=y().instances.mergeTags||[],y().components=(null===y()||void 0===y()?void 0:y().components)||{},y().components.Dropdown=j(),document.addEventListener("gform/merge_tag/initialize",U),document.addEventListener("gform/form_editor/toggle_calculation_options",W),document.addEventListener("gform/layout_editor/field_modified",W),document.addEventListener("gform/form_editor/set_field_label",W),document.addEventListener("gform/layout_editor/gform_field_deleted",W),U(),console.info("Gravity Forms Admin: Initialized Merge Tags dropdown component.")}}}]);
//# sourceMappingURL=scripts-admin.merge-tags.1b9ad8f3117affff7b37.js.map