var jQuery,mla_add_new_bulk_edit_vars,mla={settings:{},utility:{getId:function(b){var c=jQuery(b).closest("tr").attr("id"),a=c.split("-");return a[a.length-1]},attachSearch:function(b){var a=jQuery(b);jQuery(".categorydiv",a).each(function(){var d=jQuery(this).attr("id"),c,e;c=d.split("-");c.shift();c=c.join("-");e="#"+c;jQuery.extend(jQuery.expr.pseudos||jQuery.expr[":"],{matchTerms:function(h,g,f,j){return(h.textContent||h.innerText||"").toLowerCase().indexOf((f[3]||"").toLowerCase())>=0}});jQuery(e+"-searcher",a).addClass("wp-hidden-children");jQuery(e+"checklist li",a).show();jQuery("#search-"+c,a).off();jQuery("#search-"+c,a).on("keydown",function(f){if(13===f.keyCode){f.preventDefault();jQuery("#search-"+c,a).val("");jQuery(e+"-searcher",a).addClass("wp-hidden-children");jQuery(e+"checklist li",a).show();return false}});jQuery("#search-"+c,a).on("keypress",function(f){if(13===f.keyCode){f.preventDefault();jQuery("#search-"+c,a).val("");jQuery(e+"-searcher",a).addClass("wp-hidden-children");jQuery(e+"checklist li",a).show();return}});jQuery("#search-"+c,a).on("keyup",function(g){var i,h,f;if(13===g.keyCode){g.preventDefault();jQuery(e+"-search-toggle",a).trigger("focus");return}i=jQuery("#search-"+c,a).val();h=jQuery(e+"checklist li",a);if(0<i.length){h.hide()}else{h.show()}f=jQuery(e+"checklist label:matchTerms('"+i+"')",a);f.closest("li").find("li").addBack().show();f.parents(e+"checklist li",a).show()});jQuery(e+"-search-toggle",a).off();jQuery(e+"-search-toggle",a).on("click",function(){jQuery(e+"-adder ",a).addClass("wp-hidden-children");jQuery(e+"-searcher",a).toggleClass("wp-hidden-children");jQuery(e+"checklist li",a).show();if(false===jQuery(e+"-searcher",a).hasClass("wp-hidden-children")){jQuery("#search-"+c,a).val("").removeClass("form-input-tip");jQuery("#search-"+c,a).trigger("focus")}return false})})}},addNewBulkEdit:null,setParent:null};(function(a){mla.settings=typeof mla_add_new_bulk_edit_vars==="undefined"?{}:mla_add_new_bulk_edit_vars;mla_add_new_bulk_edit_vars=void 0;if(typeof mla.settings.areaOnTop==="undefined"){mla.settings.areaOnTop=false}mla.addNewBulkEdit={init:function(){var d,b,h,k,g,c,f=a(".upload-flash-bypass"),j=a("#wpbody .wrap").children("h1, h2"),e,i=a("#mla-add-new-bulk-edit-div").hide();if(typeof mla.addTerm!=="undefined"){mla.addTerm.init("#mla-add-new-bulk-edit-div")}mla.utility.attachSearch("#mla-add-new-bulk-edit-div");a("#bulk-edit-set-parent",i).on("click",function(){return mla.addNewBulkEdit.parentOpen()});d=a("#mla-preset-add-new-bulk-edit-div").detach();a("#file-form").after(d);b=a("#mla-blank-add-new-bulk-edit-div").detach();a("#file-form").after(b);h=a("#bulk-edit-toggle",i).detach();k=a("#bulk-edit-reset",i).detach();g=a("#bulk-edit-import",i).detach();c=a("#bulk-edit-export",i).detach();if(mla.settings.areaOnTop){h.appendTo(j);k.appendTo(j);g.appendTo(j);c.appendTo(j);e=i.detach();a("#media-upload-notice").before(e)}else{h.appendTo(f);k.appendTo(f);g.appendTo(f);c.appendTo(f)}h.siblings("a").on("click",function(){h.attr("title",mla.settings.toggleOpen);h.attr("value",mla.settings.toggleOpen);k.hide();g.hide();c.hide();i.hide()});h.on("click",function(){return mla.addNewBulkEdit.formToggle()});k.on("click",function(){return mla.addNewBulkEdit.doReset()});g.on("click",function(){return mla.addNewBulkEdit.doImport()});c.on("click",function(){return mla.addNewBulkEdit.doExport()});if(mla.settings.areaOpen){mla.addNewBulkEdit.formToggle()}a("textarea.mla_tags",i).each(function(){var l=a(this).attr("name").replace("]","").replace("tax_input[","");a(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+l,{delay:500,minchars:2,multiple:true,multipleSep:mla.settings.comma+" "})});uploader.bind("BeforeUpload",function(l,m){var n=a("#file-form").serialize();l.settings.multipart_params.mlaAddNewBulkEditFormString=n})},doReset:function(){var e=a("#mla-add-new-bulk-edit-div"),d=a("#mla-blank-add-new-bulk-edit-div"),b=a(".inline-edit-categories",d).html(),f=a(".inline-edit-tags",d).html(),c=a(".inline-edit-fields",d).html();a(".inline-edit-categories",e).html(b),a(".inline-edit-tags",e).html(f),a(".inline-edit-fields",e).html(c);if(typeof mla.addTerm!=="undefined"){mla.addTerm.init("#mla-add-new-bulk-edit-div")}mla.utility.attachSearch("#mla-add-new-bulk-edit-div");a("#bulk-edit-set-parent",e).on("click",function(){return mla.addNewBulkEdit.parentOpen()});return false},doImport:function(){var c=a("#mla-add-new-bulk-edit-div"),f=a("#mla-preset-add-new-bulk-edit-div"),d=a(".inline-edit-categories",f).html(),e=a(".inline-edit-tags",f).html(),b=a(".inline-edit-fields",f).html();a(".inline-edit-categories",c).html(d),a(".inline-edit-tags",c).html(e),a(".inline-edit-fields",c).html(b);if(typeof mla.addTerm!=="undefined"){mla.addTerm.init("#mla-add-new-bulk-edit-div")}mla.utility.attachSearch("#mla-add-new-bulk-edit-div");a("#bulk-edit-set-parent",c).on("click",function(){return mla.addNewBulkEdit.parentOpen()});return false},doExport:function(){var b={action:mla.settings.exportPresetsAction,mla_preset_values:a("#file-form").serialize(),mla_preset_option:mla.settings.exportPresetsOption,mla_admin_nonce:a("#mla-export-presets-ajax-nonce").val()},c=a("#mla-add-new-bulk-edit-div .spinner");if(mla.settings.useSpinnerClass){c.addClass("is-active")}else{c.show()}a.ajax(ajaxurl,{type:"POST",data:b,dataType:"json"}).always(function(d){if(mla.settings.useSpinnerClass){c.removeClass("is-active")}else{c.hide()}}).done(function(d){var e="no response.data";if(!d.success){if(d.data){e=d.data}a("#media-upload-error").html("<strong>"+mla.settings.ajaxDoneError+" ("+e+")</strong>")}else{a("#mla-preset-add-new-bulk-edit-div").html(d.data)}}).fail(function(e,d){if(200==e.status){a("#media-upload-error").text("("+d+") "+e.responseText)}else{a("#media-upload-error").text(mla.settings.ajaxFailError+" ("+d+"), jqXHR( "+e.status+", "+e.statusText+", "+e.responseText+")")}});return false},formToggle:function(){var f=a("#bulk-edit-toggle"),b=a("#bulk-edit-reset"),e=a("#bulk-edit-import"),d=a("#bulk-edit-export"),c=a("#mla-add-new-bulk-edit-div");if("none"===c.css("display")){f.attr("title",mla.settings.toggleClose);f.attr("value",mla.settings.toggleClose);b.show();e.show();d.show()}else{f.attr("title",mla.settings.toggleOpen);f.attr("value",mla.settings.toggleOpen);b.hide();e.hide();d.hide()}c.slideToggle("slow")},parentOpen:function(){var d,b,c;b=-1;c=mla.settings.uploadTitle;d=a('#mla-add-new-bulk-edit-div :input[name="post_parent"]').val()||-1;mla.setParent.open(d,b,c);a("#mla-set-parent-submit").on("click",function(e){e.preventDefault();mla.addNewBulkEdit.parentSave();return false})},parentSave:function(){var c=a("#mla-set-parent-response-div input:checked").closest("tr"),d,b;if(c.length){d=a(":radio",c).val()||"";b=a('#mla-add-new-bulk-edit-div :input[name="post_parent"]').clone(true).val(d);a('#mla-add-new-bulk-edit-div :input[name="post_parent"]').replaceWith(b)}mla.setParent.close();a("#mla-set-parent-submit").off("click")}};a(document).ready(function(){mla.addNewBulkEdit.init()})})(jQuery);